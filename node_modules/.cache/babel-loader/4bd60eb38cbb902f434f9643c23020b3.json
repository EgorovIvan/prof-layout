{"ast":null,"code":"import AccessError from \"@/components/AccessError\";\nconst API = 'http://localhost:3000'; // 'https://raw.githubusercontent.com/GeekBrainsTutorial/online-store-api/master/responses/catalogData.json';\n\nexport default {\n  name: \"App\",\n  components: {\n    AccessError\n  },\n\n  data() {\n    return {\n      catalogUrl: '/api/products',\n      cart: JSON.parse(localStorage.getItem(\"toCart\")),\n      img: './img/null.png',\n      userSearch: '',\n      cartPrice: 0,\n      error: false\n    };\n  },\n\n  methods: {\n    filter() {\n      const regexp = new RegExp(this.userSearch, 'i');\n      this.filtered = this.products.filter(product => regexp.test(product.product_name));\n    },\n\n    getJson(url) {\n      return fetch(url).then(result => result.json()).catch(error => {\n        console.log(error);\n        this.error = true;\n      });\n    },\n\n    addProduct(product) {\n      let catalogStorage = JSON.parse(localStorage.getItem(\"toCart\"));\n      let find = catalogStorage.find(item => product.id_product === item.id_product);\n\n      if (find) {\n        find.quantity++;\n      } else {\n        const prod = Object.assign({\n          quantity: 1\n        }, product);\n        catalogStorage.push(prod);\n      }\n\n      let string = JSON.stringify(catalogStorage);\n      localStorage.setItem(\"toCart\", string);\n      this.render();\n    },\n\n    clear() {\n      let collection = document.querySelectorAll('.shop-cart__item');\n\n      for (let elem of collection) {\n        elem.remove();\n      }\n\n      this.cart = [];\n      localStorage.removeItem(\"toCart\");\n      this.totalPrice();\n    },\n\n    deleteItem(id) {\n      this.cart = this.cart.filter(item => item.id_product !== id);\n      let string = JSON.stringify(this.cart);\n      localStorage.setItem(\"toCart\", string);\n      this.totalPrice();\n      console.log(this.cart);\n    },\n\n    removeCount(id) {\n      this.cart.map(item => {\n        if (item.id_product === id) {\n          item.quantity > 0 ? item.quantity-- : item.quantity = 0;\n        }\n      });\n      let string = JSON.stringify(this.cart);\n      localStorage.setItem(\"toCart\", string);\n      this.totalPrice();\n    },\n\n    addCount(id) {\n      this.cart.map(item => {\n        if (item.id_product === id) {\n          item.quantity++;\n        }\n      });\n      let string = JSON.stringify(this.cart);\n      localStorage.setItem(\"toCart\", string);\n      this.totalPrice();\n    },\n\n    totalPrice() {\n      let sum = 0;\n      this.cart.map(product => {\n        return sum += product.price * product.quantity;\n      });\n      this.cartPrice = sum;\n    },\n\n    render() {\n      this.cart = JSON.parse(localStorage.getItem(\"toCart\"));\n    }\n\n  },\n\n  mounted() {\n    this.getJson(`${API + this.catalogUrl}`).then(data => {\n      for (let el of data) {\n        this.products.push(el);\n      }\n\n      localStorage.setItem(\"toCart\", JSON.stringify([]));\n      this.filter();\n      this.totalPrice();\n      this.render();\n    });\n  }\n\n};","map":{"version":3,"mappings":"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","names":["AccessError","API","name","components","data","catalogUrl","cart","JSON","parse","localStorage","getItem","img","userSearch","cartPrice","error","methods","filter","regexp","RegExp","filtered","products","product","test","product_name","getJson","url","fetch","then","result","json","catch","console","log","addProduct","catalogStorage","find","item","id_product","quantity","prod","Object","assign","push","string","stringify","setItem","render","clear","collection","document","querySelectorAll","elem","remove","removeItem","totalPrice","deleteItem","id","removeCount","map","addCount","sum","price","mounted","el"],"sourceRoot":"","sources":["C:\\Project\\Geekbrains\\prof-layout\\src\\App.vue"],"sourcesContent":["<template>\r\n\t<div v-if=\"error\">\r\n\t\t<AccessError/>\r\n\t</div>\r\n\t<div v-else>\r\n\t\t<router-view/>\r\n\t</div>\r\n</template>\r\n\t\r\n\r\n<script>\r\n\timport AccessError from \"@/components/AccessError\";\r\n\t\r\n\tconst API = 'http://localhost:3000';\r\n\t\t// 'https://raw.githubusercontent.com/GeekBrainsTutorial/online-store-api/master/responses/catalogData.json';\r\n\t\r\n\texport default {\r\n\t\tname: \"App\",\r\n\t\tcomponents: {\r\n\t\t\tAccessError\r\n\t\t},\r\n\t\tdata() {\r\n\t\t\treturn {\r\n\t\t\t\tcatalogUrl: '/api/products',\r\n\r\n\t\t\t\tcart: JSON.parse(localStorage.getItem(\"toCart\")),\r\n\t\t\t\timg: './img/null.png',\r\n\t\t\t\tuserSearch: '',\r\n\t\t\t\tcartPrice: 0,\r\n\t\t\t\terror: false,\r\n\t\t\t}\r\n\t\t},\r\n\t\tmethods: {\r\n\t\t\tfilter() {\r\n\t\t\t\tconst regexp = new RegExp(this.userSearch, 'i');\r\n\t\t\t\tthis.filtered = this.products.filter(product => regexp.test(product.product_name));\r\n\t\t\t},\r\n\t\t\tgetJson(url) {\r\n\t\t\t\treturn fetch(url)\r\n\t\t\t\t\t.then(result => result.json())\r\n\t\t\t\t\t.catch(error => {\r\n\t\t\t\t\t\tconsole.log(error);\r\n\t\t\t\t\t\tthis.error = true;\r\n\t\t\t\t\t})\r\n\t\t\t},\r\n\t\t\taddProduct(product) {\r\n\t\t\t\tlet catalogStorage = JSON.parse(localStorage.getItem(\"toCart\"));\r\n\t\t\t\tlet find = catalogStorage.find((item => product.id_product === item.id_product))\r\n\t\t\t\tif (find) {\r\n\t\t\t\t\tfind.quantity++;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tconst prod = Object.assign({quantity: 1}, product);\r\n\t\t\t\t\tcatalogStorage.push(prod);\r\n\t\t\t\t}\r\n\t\t\t\tlet string = JSON.stringify(catalogStorage);\r\n\t\t\t\tlocalStorage.setItem(\"toCart\", string);\r\n\t\t\t\tthis.render();\r\n\t\t\t},\r\n\t\t\tclear() {\r\n\t\t\t\tlet collection = document.querySelectorAll('.shop-cart__item');\r\n\t\t\t\tfor (let elem of collection) {\r\n\t\t\t\t\telem.remove();\r\n\t\t\t\t}\r\n\t\t\t\tthis.cart = [];\r\n\t\t\t\tlocalStorage.removeItem(\"toCart\");\r\n\t\t\t\tthis.totalPrice();\r\n\t\t\t},\r\n\t\t\tdeleteItem(id) {\r\n\t\t\t\tthis.cart = this.cart.filter(item => item.id_product !== id)\r\n\t\t\t\tlet string = JSON.stringify(this.cart);\r\n\t\t\t\tlocalStorage.setItem(\"toCart\", string);\r\n\t\t\t\tthis.totalPrice();\r\n\t\t\t\tconsole.log(this.cart)\r\n\t\t\t},\r\n\t\t\tremoveCount(id) {\r\n\t\t\t\tthis.cart.map(item => {\r\n\t\t\t\t\tif (item.id_product === id) {\r\n\t\t\t\t\t\titem.quantity > 0 ? item.quantity-- : item.quantity = 0;\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t\tlet string = JSON.stringify(this.cart);\r\n\t\t\t\tlocalStorage.setItem(\"toCart\", string);\r\n\t\t\t\tthis.totalPrice();\r\n\t\t\t},\r\n\t\t\taddCount(id) {\r\n\t\t\t\tthis.cart.map(item => {\r\n\t\t\t\t\tif (item.id_product === id) {\r\n\t\t\t\t\t\titem.quantity++;\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t\tlet string = JSON.stringify(this.cart);\r\n\t\t\t\tlocalStorage.setItem(\"toCart\", string);\r\n\t\t\t\tthis.totalPrice();\r\n\t\t\t},\r\n\t\t\ttotalPrice() {\r\n\t\t\t\tlet sum = 0;\r\n\t\t\t\tthis.cart.map(product => {\r\n\t\t\t\t\treturn sum += product.price * product.quantity\r\n\t\t\t\t});\r\n\t\t\t\tthis.cartPrice = sum;\r\n\t\t\t},\r\n\t\t\trender() {\r\n\t\t\t\tthis.cart = JSON.parse(localStorage.getItem(\"toCart\"));\r\n\t\t\t}\r\n\t\t},\r\n\t\tmounted() {\r\n\t\t\tthis.getJson(`${API + this.catalogUrl}`)\r\n\t\t\t\t.then(data => {\r\n\t\t\t\t\tfor (let el of data) {\r\n\t\t\t\t\t\tthis.products.push(el);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tlocalStorage.setItem(\"toCart\", JSON.stringify([]));\r\n\t\t\t\t\tthis.filter();\r\n\t\t\t\t\tthis.totalPrice();\r\n\t\t\t\t\tthis.render()\r\n\t\t\t\t});\r\n\t\t},\r\n\t}\r\n</script>\r\n"]},"metadata":{},"sourceType":"module"}